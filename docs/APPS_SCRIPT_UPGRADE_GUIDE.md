# Apps Script v3.0 ì—…ê·¸ë ˆì´ë“œ ê°€ì´ë“œ

## ğŸ¯ ëª©í‘œ

ê¸°ì¡´ Apps Script v2.0ì—ì„œ v3.0ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œí•˜ì—¬ `batchVerify`ì™€ `getHandStatus` ì•¡ì…˜ì„ ì¶”ê°€í•©ë‹ˆë‹¤.

## ğŸ“‹ í˜„ì¬ ìƒí™©

- **ê¸°ì¡´ ë²„ì „**: v2.0 (appscripts_old.gs)
- **ìƒˆ ë²„ì „**: v3.0 (apps_script_FINAL.gs)
- **ë¬¸ì œ**: í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ìƒˆ ì•¡ì…˜ í˜¸ì¶œ ì‹œ "ì•Œ ìˆ˜ ì—†ëŠ” ì•¡ì…˜" ì˜¤ë¥˜

## ğŸ› ï¸ ë‹¨ê³„ë³„ ì—…ê·¸ë ˆì´ë“œ ê°€ì´ë“œ

### 1ë‹¨ê³„: ê¸°ì¡´ ì½”ë“œ ë°±ì—…
```
í˜„ì¬ Google Apps Script ì½˜ì†”ì˜ ì½”ë“œë¥¼ ë³µì‚¬í•´ì„œ ë³„ë„ ë³´ê´€
```

### 2ë‹¨ê³„: ìƒˆ í…œí”Œë¦¿ ê¸°ë°˜ìœ¼ë¡œ ì™„ì „í•œ ì½”ë“œ ì¤€ë¹„

#### ğŸ“„ í•„ìš”í•œ íŒŒì¼ë“¤
- `scripts/appscripts_old.gs` (ê¸°ì¡´ ì½”ë“œ)
- `scripts/apps_script_FINAL.gs` (ìƒˆ í…œí”Œë¦¿)

#### ğŸ”§ í†µí•© ì‘ì—…
1. **apps_script_FINAL.gs**ë¥¼ ê¸°ë³¸ êµ¬ì¡°ë¡œ ì‚¬ìš©
2. **appscripts_old.gs**ì—ì„œ ë‹¤ìŒ í•¨ìˆ˜ë“¤ì˜ **ì „ì²´ ì½”ë“œ** ë³µì‚¬:

```javascript
// í•„ìˆ˜ ë³µì‚¬ ëŒ€ìƒ í•¨ìˆ˜ë“¤
function handleSheetUpdate(data) { /* ì „ì²´ ì½”ë“œ */ }
function handleHandUpdate(data) { /* ì „ì²´ ì½”ë“œ */ }
function handleHandAnalysis(data) { /* ì „ì²´ ì½”ë“œ */ }
function handleIndexUpdate(data) { /* ì „ì²´ ì½”ë“œ */ }
function handleSheetUpdateV2(data) { /* ì „ì²´ ì½”ë“œ */ }
function handleVerifyUpdate(data) { /* ì „ì²´ ì½”ë“œ */ }

// ì¶”ê°€ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
function buildDefaultAnalysis() { /* ì „ì²´ ì½”ë“œ */ }
function updateIndexSheet() { /* ì „ì²´ ì½”ë“œ */ }
// ê¸°íƒ€ í•„ìš”í•œ ëª¨ë“  í•¨ìˆ˜ë“¤
```

### 3ë‹¨ê³„: Google Apps Script ë°°í¬

#### ğŸ“ ë°°í¬ ìˆœì„œ
1. **script.google.com** ì ‘ì†
2. í•´ë‹¹ í”„ë¡œì íŠ¸ ì—´ê¸°
3. **ê¸°ì¡´ ì½”ë“œ ì „ì²´ ì‚­ì œ**
4. **ì™„ì„±ëœ í†µí•© ì½”ë“œ ë¶™ì—¬ë„£ê¸°**
5. **ì €ì¥** (Ctrl+S)
6. **"ë°°í¬ > ìƒˆ ë°°í¬ ë§Œë“¤ê¸°"** í´ë¦­
7. ì„¤ì •:
   - ìœ í˜•: **ì›¹ ì•±**
   - ì‹¤í–‰ ëŒ€ìƒ: **ë‚˜**
   - ì•¡ì„¸ìŠ¤ ê¶Œí•œ: **ëª¨ë“  ì‚¬ìš©ì**
8. **ë°°í¬** í´ë¦­
9. **ìƒˆ ì›¹ ì•± URL ë³µì‚¬**

### 4ë‹¨ê³„: í”„ë¡ íŠ¸ì—”ë“œ URL ì—…ë°ì´íŠ¸

ìƒˆë¡œ ë°›ì€ Apps Script URLì„ í”„ë¡ íŠ¸ì—”ë“œ ì„¤ì •ì—ì„œ êµì²´

### 5ë‹¨ê³„: ì—°ê²° í…ŒìŠ¤íŠ¸

ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ í™•ì¸:
```javascript
// ì˜ˆìƒ ë¡œê·¸
ğŸ“Š í˜„ì¬ ë°°í¬ëœ Apps Script ë²„ì „: v3.0
ğŸ“Š ì§€ì› ê¸°ëŠ¥: ['Sheet Update', 'Batch Verify', 'Hand Status Check', ...]
âœ… batchVerify ì•¡ì…˜ ì„±ê³µ
âœ… getHandStatus ì•¡ì…˜ ì„±ê³µ
```

## ğŸ”§ ìƒˆ ì•¡ì…˜ ìƒì„¸

### ğŸ“Š batchVerify
```javascript
// ìš”ì²­
{
  action: 'batchVerify',
  sheetUrl: 'https://docs.google.com/spreadsheets/...',
  rows: [100, 101, 102, 103]
}

// ì‘ë‹µ
{
  status: 'success',
  result: {
    data: {
      100: { row: 100, status: 'ë¯¸ì™„ë£Œ', timestamp: '...' },
      101: { row: 101, status: 'ë³µì‚¬ì™„ë£Œ', timestamp: '...' },
      102: { row: 102, status: '', timestamp: '...' },
      103: { row: 103, status: 'ë¯¸ì™„ë£Œ', timestamp: '...' }
    }
  }
}
```

### ğŸ¯ getHandStatus
```javascript
// ìš”ì²­
{
  action: 'getHandStatus',
  sheetUrl: 'https://docs.google.com/spreadsheets/...',
  handNumber: 139,
  handTime: 1726654800
}

// ì‘ë‹µ (ì„±ê³µ)
{
  status: 'success',
  handNumber: 139,
  matchedRow: 619,
  handStatus: 'ë¯¸ì™„ë£Œ',
  matchType: 'exact',
  timeDiff: 0
}

// ì‘ë‹µ (ì‹¤íŒ¨)
{
  status: 'not_found',
  handNumber: 139,
  message: 'í•¸ë“œ #139ì— í•´ë‹¹í•˜ëŠ” Virtual ì‹œíŠ¸ í–‰ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ'
}
```

## âš ï¸ ì£¼ì˜ì‚¬í•­

### ğŸ”´ ë¡œì§ ì¶©ëŒ ë°©ì§€
- ê¸°ì¡´ ì•¡ì…˜ë“¤(`updateSheet`, `updateSheetV2` ë“±)ì€ **ì™„ì „íˆ ë™ì¼í•˜ê²Œ ì‘ë™**
- ìƒˆ ì•¡ì…˜ë“¤ì€ **ê¸°ì¡´ ë¡œì§ì— ì˜í–¥ ì—†ìŒ**
- ë²„ì „ í˜¸í™˜ì„± ì™„ì „ ë³´ì¥

### ğŸ”„ ë¡¤ë°± ê³„íš
ë¬¸ì œ ë°œìƒ ì‹œ:
1. 1ë‹¨ê³„ì—ì„œ ë°±ì—…í•œ ê¸°ì¡´ ì½”ë“œë¡œ ë³µì›
2. ê¸°ì¡´ ë°°í¬ URL ì¬ì‚¬ìš©
3. í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ìºì‹œ ì „ìš© ëª¨ë“œë¡œ ì‘ë™

## ğŸ“Š ì˜ˆìƒ íš¨ê³¼

### âœ… ì„±ê³µ ì‹œ
- âŒ "ì•Œ ìˆ˜ ì—†ëŠ” ì•¡ì…˜" ì˜¤ë¥˜ í•´ê²°
- âœ… ì¼ê´„ ìƒíƒœ í™•ì¸ ì†ë„ í–¥ìƒ
- âœ… ê°œë³„ í•¸ë“œ ë§¤ì¹­ ì •í™•ë„ í–¥ìƒ

### ğŸ“ˆ ì„±ëŠ¥ ê°œì„ 
- **ê¸°ì¡´**: 121ê°œ í•¸ë“œ Ã— ê°œë³„ API í˜¸ì¶œ = 121íšŒ
- **ì‹ ê·œ**: 121ê°œ í•¸ë“œ Ã· ë°°ì¹˜ í¬ê¸° = ì•½ 10-15íšŒ

## ğŸ¯ ìµœì¢… í™•ì¸ì‚¬í•­

ë°°í¬ ì™„ë£Œ í›„ ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ:
```
âœ… Apps Script v3.0 ì—°ê²° ì„±ê³µ
âœ… ì§€ì› ì•¡ì…˜: ['updateSheet', 'batchVerify', 'getHandStatus', ...]
ğŸš€ CSV íŒŒì‹± ìºì‹œ íˆíŠ¸: 1888ê°œ í–‰
âœ… ì‹œê°„ ë§¤ì¹­ ì„±ê³µ: í•¸ë“œ #139 ìƒíƒœ = ë¯¸ì™„ë£Œ
```

ëª¨ë“  ë¡œê·¸ê°€ ì •ìƒì´ë©´ ì—…ê·¸ë ˆì´ë“œ ì„±ê³µ! ğŸ‰