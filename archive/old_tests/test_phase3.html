<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Phase 3 í…ŒìŠ¤íŠ¸ - v11.2.0</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background: #f5f5f5;
    }
    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      border-radius: 10px;
      margin-bottom: 30px;
    }
    .test-section {
      background: white;
      padding: 25px;
      border-radius: 10px;
      margin-bottom: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .test-title {
      font-size: 20px;
      font-weight: bold;
      color: #333;
      margin-bottom: 15px;
      border-bottom: 2px solid #667eea;
      padding-bottom: 10px;
    }
    .test-controls {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin: 15px 0;
    }
    button {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }
    .btn-primary {
      background: #667eea;
      color: white;
    }
    .btn-primary:hover {
      background: #5a67d8;
      transform: translateY(-2px);
    }
    .btn-success {
      background: #48bb78;
      color: white;
    }
    .btn-danger {
      background: #f56565;
      color: white;
    }
    .btn-warning {
      background: #ed8936;
      color: white;
    }
    .test-output {
      background: #f7fafc;
      padding: 15px;
      border-radius: 5px;
      margin-top: 15px;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      max-height: 300px;
      overflow-y: auto;
      border: 1px solid #e2e8f0;
    }
    .status-indicator {
      display: inline-block;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      margin-right: 5px;
    }
    .status-active {
      background: #48bb78;
      animation: pulse 2s infinite;
    }
    .status-inactive {
      background: #cbd5e0;
    }
    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.5; }
      100% { opacity: 1; }
    }
    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }
    .metric-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
    }
    .metric-value {
      font-size: 24px;
      font-weight: bold;
      margin-top: 5px;
    }
    .test-result {
      padding: 8px;
      margin: 5px 0;
      border-radius: 5px;
    }
    .test-pass {
      background: #c6f6d5;
      color: #22543d;
    }
    .test-fail {
      background: #fed7d7;
      color: #742a2a;
    }
    .test-pending {
      background: #feebc8;
      color: #744210;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>ğŸš€ Phase 3 ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ëŒ€ì‹œë³´ë“œ</h1>
    <p>Version 11.2.0 - ìŠ¤ë§ˆíŠ¸ ìƒˆë¡œê³ ì¹¨ ë° ë¡œì»¬ ì €ì¥ì†Œ í…ŒìŠ¤íŠ¸</p>
    <p>í…ŒìŠ¤íŠ¸ ì‹œê°„: <span id="test-time"></span></p>
  </div>

  <!-- Phase 3-A: SmartRefreshManager í…ŒìŠ¤íŠ¸ -->
  <div class="test-section">
    <div class="test-title">
      <span class="status-indicator status-inactive" id="smart-refresh-status"></span>
      Phase 3-A: SmartRefreshManager í…ŒìŠ¤íŠ¸
    </div>
    <div class="test-controls">
      <button class="btn-primary" onclick="testSmartRefresh()">ìŠ¤ë§ˆíŠ¸ ìƒˆë¡œê³ ì¹¨ í…ŒìŠ¤íŠ¸</button>
      <button class="btn-success" onclick="simulateActivity()">í™œë™ ì‹œë®¬ë ˆì´ì…˜</button>
      <button class="btn-warning" onclick="simulateInactivity()">ë¹„í™œë™ ì‹œë®¬ë ˆì´ì…˜</button>
      <button class="btn-danger" onclick="toggleSmartRefresh()">í† ê¸€ ON/OFF</button>
    </div>
    <div class="metrics-grid">
      <div class="metric-card">
        <div>í˜„ì¬ ê°„ê²©</div>
        <div class="metric-value" id="current-interval">30ì´ˆ</div>
      </div>
      <div class="metric-card">
        <div>í™œë™ ìƒíƒœ</div>
        <div class="metric-value" id="activity-status">ë¹„í™œë™</div>
      </div>
      <div class="metric-card">
        <div>ìƒˆë¡œê³ ì¹¨ íšŸìˆ˜</div>
        <div class="metric-value" id="refresh-count">0</div>
      </div>
    </div>
    <div class="test-output" id="smart-refresh-output"></div>
  </div>

  <!-- Phase 3-B: LocalDataStore (IndexedDB) í…ŒìŠ¤íŠ¸ -->
  <div class="test-section">
    <div class="test-title">
      <span class="status-indicator status-inactive" id="indexeddb-status"></span>
      Phase 3-B: LocalDataStore (IndexedDB) í…ŒìŠ¤íŠ¸
    </div>
    <div class="test-controls">
      <button class="btn-primary" onclick="testIndexedDB()">IndexedDB í…ŒìŠ¤íŠ¸</button>
      <button class="btn-success" onclick="saveTestData()">í…ŒìŠ¤íŠ¸ ë°ì´í„° ì €ì¥</button>
      <button class="btn-warning" onclick="loadTestData()">í…ŒìŠ¤íŠ¸ ë°ì´í„° ë¡œë“œ</button>
      <button class="btn-danger" onclick="clearIndexedDB()">IndexedDB ì´ˆê¸°í™”</button>
    </div>
    <div class="metrics-grid">
      <div class="metric-card">
        <div>ì €ì¥ì†Œ í¬ê¸°</div>
        <div class="metric-value" id="storage-size">0 KB</div>
      </div>
      <div class="metric-card">
        <div>ì €ì¥ëœ í•¸ë“œ</div>
        <div class="metric-value" id="stored-hands">0</div>
      </div>
      <div class="metric-card">
        <div>ìºì‹œëœ í–‰</div>
        <div class="metric-value" id="cached-rows">0</div>
      </div>
    </div>
    <div class="test-output" id="indexeddb-output"></div>
  </div>

  <!-- Phase 3-C: í†µí•© ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ -->
  <div class="test-section">
    <div class="test-title">
      <span class="status-indicator status-inactive" id="performance-status"></span>
      Phase 3-C: í†µí•© ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
    </div>
    <div class="test-controls">
      <button class="btn-primary" onclick="runFullTest()">ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
      <button class="btn-success" onclick="testOfflineMode()">ì˜¤í”„ë¼ì¸ ëª¨ë“œ í…ŒìŠ¤íŠ¸</button>
      <button class="btn-warning" onclick="testMemoryUsage()">ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í…ŒìŠ¤íŠ¸</button>
    </div>
    <div class="test-output" id="performance-output"></div>
  </div>

  <!-- í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½ -->
  <div class="test-section">
    <div class="test-title">ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½</div>
    <div id="test-summary">
      <div class="test-result test-pending">í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•˜ë ¤ë©´ ìœ„ì˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.</div>
    </div>
  </div>

  <script>
    // ì „ì—­ ë³€ìˆ˜
    let smartRefreshManager = null;
    let localDataStore = null;
    let refreshCount = 0;
    let testResults = [];

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
    document.addEventListener('DOMContentLoaded', () => {
      updateTestTime();
      initializePhase3Components();
    });

    function updateTestTime() {
      const now = new Date();
      document.getElementById('test-time').textContent = now.toLocaleString('ko-KR');
    }

    function log(section, message, isError = false) {
      const output = document.getElementById(section + '-output');
      const timestamp = new Date().toLocaleTimeString();
      const color = isError ? 'color: #e53e3e;' : 'color: #2d3748;';
      output.innerHTML += `<div style="${color}">[${timestamp}] ${message}</div>`;
      output.scrollTop = output.scrollHeight;
    }

    // Phase 3 ì»´í¬ë„ŒíŠ¸ ì´ˆê¸°í™”
    async function initializePhase3Components() {
      try {
        // SmartRefreshManager ì´ˆê¸°í™”
        smartRefreshManager = {
          refreshInterval: 30000,
          minInterval: 10000,
          maxInterval: 300000,
          isActive: false,
          isEnabled: false,
          lastActivity: Date.now(),

          detectActivity() {
            this.lastActivity = Date.now();
            this.isActive = true;
            this.adjustInterval();
          },

          adjustInterval() {
            if (this.isActive) {
              this.refreshInterval = Math.max(this.minInterval, this.refreshInterval * 0.5);
            } else {
              this.refreshInterval = Math.min(this.maxInterval, this.refreshInterval * 1.5);
            }
            document.getElementById('current-interval').textContent = `${Math.round(this.refreshInterval/1000)}ì´ˆ`;
          },

          toggle() {
            this.isEnabled = !this.isEnabled;
            const statusEl = document.getElementById('smart-refresh-status');
            if (this.isEnabled) {
              statusEl.classList.add('status-active');
              statusEl.classList.remove('status-inactive');
            } else {
              statusEl.classList.remove('status-active');
              statusEl.classList.add('status-inactive');
            }
            return this.isEnabled;
          }
        };

        // LocalDataStore ì´ˆê¸°í™”
        if ('indexedDB' in window) {
          const request = indexedDB.open('TestPokerDB', 1);

          request.onupgradeneeded = (event) => {
            const db = event.target.result;

            if (!db.objectStoreNames.contains('hands')) {
              db.createObjectStore('hands', { keyPath: 'handNumber' });
            }
            if (!db.objectStoreNames.contains('sheetCache')) {
              const store = db.createObjectStore('sheetCache', { keyPath: 'rowNumber' });
              store.createIndex('timestamp', 'timestamp', { unique: false });
            }
            if (!db.objectStoreNames.contains('settings')) {
              db.createObjectStore('settings', { keyPath: 'key' });
            }
          };

          request.onsuccess = (event) => {
            localDataStore = {
              db: event.target.result,

              async saveHand(hand) {
                return new Promise((resolve, reject) => {
                  const transaction = this.db.transaction(['hands'], 'readwrite');
                  const store = transaction.objectStore('hands');
                  const request = store.put(hand);
                  request.onsuccess = () => resolve(true);
                  request.onerror = () => reject(request.error);
                });
              },

              async getStorageSize() {
                if (navigator.storage?.estimate) {
                  const estimate = await navigator.storage.estimate();
                  return estimate.usage || 0;
                }
                return 0;
              },

              async clearAll() {
                return new Promise((resolve, reject) => {
                  const transaction = this.db.transaction(['hands', 'sheetCache', 'settings'], 'readwrite');
                  transaction.objectStore('hands').clear();
                  transaction.objectStore('sheetCache').clear();
                  transaction.objectStore('settings').clear();
                  transaction.oncomplete = () => resolve();
                  transaction.onerror = () => reject(transaction.error);
                });
              }
            };

            document.getElementById('indexeddb-status').classList.add('status-active');
            document.getElementById('indexeddb-status').classList.remove('status-inactive');
            log('indexeddb', 'âœ… IndexedDB ì´ˆê¸°í™” ì„±ê³µ');
          };

          request.onerror = () => {
            log('indexeddb', 'âŒ IndexedDB ì´ˆê¸°í™” ì‹¤íŒ¨', true);
          };
        } else {
          log('indexeddb', 'âš ï¸ ë¸Œë¼ìš°ì €ê°€ IndexedDBë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤', true);
        }

        log('smart-refresh', 'âœ… Phase 3 ì»´í¬ë„ŒíŠ¸ ì´ˆê¸°í™” ì™„ë£Œ');
      } catch (error) {
        log('performance', `âŒ ì´ˆê¸°í™” ì˜¤ë¥˜: ${error.message}`, true);
      }
    }

    // SmartRefreshManager í…ŒìŠ¤íŠ¸
    async function testSmartRefresh() {
      log('smart-refresh', 'ğŸ”„ SmartRefreshManager í…ŒìŠ¤íŠ¸ ì‹œì‘...');

      const tests = [
        { name: 'ì´ˆê¸° ìƒíƒœ í™•ì¸', passed: smartRefreshManager !== null },
        { name: 'ìƒˆë¡œê³ ì¹¨ ê°„ê²© ì¡°ì •', passed: true },
        { name: 'í™œë™ ê°ì§€', passed: true },
        { name: 'í† ê¸€ ê¸°ëŠ¥', passed: true }
      ];

      // ê°„ê²© ì¡°ì • í…ŒìŠ¤íŠ¸
      const initialInterval = smartRefreshManager.refreshInterval;
      smartRefreshManager.detectActivity();
      tests[1].passed = smartRefreshManager.refreshInterval < initialInterval;

      // í™œë™ ê°ì§€ í…ŒìŠ¤íŠ¸
      const lastActivity = smartRefreshManager.lastActivity;
      await new Promise(resolve => setTimeout(resolve, 100));
      smartRefreshManager.detectActivity();
      tests[2].passed = smartRefreshManager.lastActivity > lastActivity;

      // í† ê¸€ í…ŒìŠ¤íŠ¸
      const wasEnabled = smartRefreshManager.isEnabled;
      smartRefreshManager.toggle();
      tests[3].passed = smartRefreshManager.isEnabled !== wasEnabled;
      smartRefreshManager.toggle(); // ì›ìƒë³µêµ¬

      // ê²°ê³¼ í‘œì‹œ
      tests.forEach(test => {
        const status = test.passed ? 'âœ…' : 'âŒ';
        log('smart-refresh', `${status} ${test.name}`);
      });

      updateTestSummary('SmartRefreshManager', tests);
    }

    function simulateActivity() {
      smartRefreshManager.detectActivity();
      document.getElementById('activity-status').textContent = 'í™œë™ì¤‘';
      log('smart-refresh', 'ğŸ‘† ì‚¬ìš©ì í™œë™ ì‹œë®¬ë ˆì´ì…˜');

      setTimeout(() => {
        document.getElementById('activity-status').textContent = 'ë¹„í™œë™';
        smartRefreshManager.isActive = false;
        smartRefreshManager.adjustInterval();
      }, 5000);
    }

    function simulateInactivity() {
      smartRefreshManager.isActive = false;
      smartRefreshManager.adjustInterval();
      document.getElementById('activity-status').textContent = 'ë¹„í™œë™';
      log('smart-refresh', 'ğŸ’¤ ë¹„í™œë™ ìƒíƒœ ì‹œë®¬ë ˆì´ì…˜');
    }

    function toggleSmartRefresh() {
      const enabled = smartRefreshManager.toggle();
      log('smart-refresh', `ğŸ”„ ìŠ¤ë§ˆíŠ¸ ìƒˆë¡œê³ ì¹¨: ${enabled ? 'ON' : 'OFF'}`);

      if (enabled) {
        simulateRefreshCycle();
      }
    }

    function simulateRefreshCycle() {
      if (!smartRefreshManager.isEnabled) return;

      refreshCount++;
      document.getElementById('refresh-count').textContent = refreshCount;
      log('smart-refresh', `ğŸ”„ ìƒˆë¡œê³ ì¹¨ #${refreshCount} ì‹¤í–‰ (ê°„ê²©: ${Math.round(smartRefreshManager.refreshInterval/1000)}ì´ˆ)`);

      setTimeout(() => simulateRefreshCycle(), smartRefreshManager.refreshInterval);
    }

    // IndexedDB í…ŒìŠ¤íŠ¸
    async function testIndexedDB() {
      log('indexeddb', 'ğŸ”„ IndexedDB í…ŒìŠ¤íŠ¸ ì‹œì‘...');

      const tests = [
        { name: 'DB ì—°ê²° ìƒíƒœ', passed: localDataStore && localDataStore.db !== null },
        { name: 'ë°ì´í„° ì €ì¥', passed: false },
        { name: 'ë°ì´í„° ì¡°íšŒ', passed: false },
        { name: 'ì €ì¥ì†Œ í¬ê¸° í™•ì¸', passed: false },
        { name: 'ë°ì´í„° ì‚­ì œ', passed: false }
      ];

      try {
        // ë°ì´í„° ì €ì¥ í…ŒìŠ¤íŠ¸
        await localDataStore.saveHand({ handNumber: 'TEST-001', data: 'test data' });
        tests[1].passed = true;

        // ë°ì´í„° ì¡°íšŒ í…ŒìŠ¤íŠ¸
        const transaction = localDataStore.db.transaction(['hands'], 'readonly');
        const store = transaction.objectStore('hands');
        const request = store.get('TEST-001');
        await new Promise((resolve, reject) => {
          request.onsuccess = () => {
            tests[2].passed = request.result !== undefined;
            resolve();
          };
          request.onerror = reject;
        });

        // ì €ì¥ì†Œ í¬ê¸° í™•ì¸
        const size = await localDataStore.getStorageSize();
        tests[3].passed = size >= 0;
        document.getElementById('storage-size').textContent = `${Math.round(size/1024)} KB`;

        // ë°ì´í„° ì‚­ì œ í…ŒìŠ¤íŠ¸
        await localDataStore.clearAll();
        tests[4].passed = true;

      } catch (error) {
        log('indexeddb', `âŒ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}`, true);
      }

      // ê²°ê³¼ í‘œì‹œ
      tests.forEach(test => {
        const status = test.passed ? 'âœ…' : 'âŒ';
        log('indexeddb', `${status} ${test.name}`);
      });

      updateTestSummary('IndexedDB', tests);
    }

    async function saveTestData() {
      try {
        const testData = [];
        for (let i = 1; i <= 10; i++) {
          testData.push({
            handNumber: `HAND-${i.toString().padStart(3, '0')}`,
            timestamp: Date.now() - (i * 60000),
            pot: Math.floor(Math.random() * 1000),
            players: 6
          });
        }

        for (const hand of testData) {
          await localDataStore.saveHand(hand);
        }

        document.getElementById('stored-hands').textContent = testData.length;
        log('indexeddb', `âœ… ${testData.length}ê°œ í…ŒìŠ¤íŠ¸ ë°ì´í„° ì €ì¥ ì™„ë£Œ`);

        const size = await localDataStore.getStorageSize();
        document.getElementById('storage-size').textContent = `${Math.round(size/1024)} KB`;
      } catch (error) {
        log('indexeddb', `âŒ ë°ì´í„° ì €ì¥ ì‹¤íŒ¨: ${error.message}`, true);
      }
    }

    async function loadTestData() {
      try {
        const transaction = localDataStore.db.transaction(['hands'], 'readonly');
        const store = transaction.objectStore('hands');
        const request = store.getAll();

        request.onsuccess = () => {
          const hands = request.result;
          log('indexeddb', `âœ… ${hands.length}ê°œ í•¸ë“œ ë¡œë“œ ì™„ë£Œ`);
          hands.forEach((hand, index) => {
            if (index < 3) { // ì²˜ìŒ 3ê°œë§Œ í‘œì‹œ
              log('indexeddb', `  - ${hand.handNumber}: POT ${hand.pot}`);
            }
          });
          if (hands.length > 3) {
            log('indexeddb', `  ... ì™¸ ${hands.length - 3}ê°œ`);
          }
        };
      } catch (error) {
        log('indexeddb', `âŒ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ${error.message}`, true);
      }
    }

    async function clearIndexedDB() {
      try {
        await localDataStore.clearAll();
        document.getElementById('stored-hands').textContent = '0';
        document.getElementById('cached-rows').textContent = '0';
        document.getElementById('storage-size').textContent = '0 KB';
        log('indexeddb', 'âœ… IndexedDB ì´ˆê¸°í™” ì™„ë£Œ');
      } catch (error) {
        log('indexeddb', `âŒ ì´ˆê¸°í™” ì‹¤íŒ¨: ${error.message}`, true);
      }
    }

    // í†µí•© ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
    async function runFullTest() {
      log('performance', 'ğŸš€ Phase 3 ì „ì²´ í†µí•© í…ŒìŠ¤íŠ¸ ì‹œì‘...');

      const startTime = performance.now();

      // 1. SmartRefreshManager í…ŒìŠ¤íŠ¸
      await testSmartRefresh();

      // 2. IndexedDB í…ŒìŠ¤íŠ¸
      await testIndexedDB();

      // 3. í†µí•© ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸
      log('performance', 'ğŸ“Š í†µí•© ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸...');

      // ë°ì´í„° ì €ì¥ ë° ìŠ¤ë§ˆíŠ¸ ìƒˆë¡œê³ ì¹¨ ì—°ë™
      await saveTestData();
      simulateActivity();

      const endTime = performance.now();
      const totalTime = (endTime - startTime).toFixed(2);

      log('performance', `âœ… ì „ì²´ í…ŒìŠ¤íŠ¸ ì™„ë£Œ (ì†Œìš”ì‹œê°„: ${totalTime}ms)`);

      // ì„±ëŠ¥ ë©”íŠ¸ë¦­ í‘œì‹œ
      const metrics = {
        'í…ŒìŠ¤íŠ¸ ì†Œìš”ì‹œê°„': `${totalTime}ms`,
        'ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰': await getMemoryUsage(),
        'IndexedDB ì§€ì›': localDataStore ? 'âœ…' : 'âŒ',
        'SmartRefresh ìƒíƒœ': smartRefreshManager.isEnabled ? 'ON' : 'OFF'
      };

      Object.entries(metrics).forEach(([key, value]) => {
        log('performance', `  ${key}: ${value}`);
      });
    }

    async function testOfflineMode() {
      log('performance', 'ğŸ”Œ ì˜¤í”„ë¼ì¸ ëª¨ë“œ í…ŒìŠ¤íŠ¸...');

      // ì˜¨ë¼ì¸ ìƒíƒœì—ì„œ ë°ì´í„° ì €ì¥
      await saveTestData();
      log('performance', 'âœ… ì˜¨ë¼ì¸ ìƒíƒœì—ì„œ ë°ì´í„° ì €ì¥ ì™„ë£Œ');

      // ì˜¤í”„ë¼ì¸ ì‹œë®¬ë ˆì´ì…˜
      log('performance', 'ğŸ“µ ì˜¤í”„ë¼ì¸ ëª¨ë“œ ì „í™˜...');

      // IndexedDBì—ì„œ ë°ì´í„° ë¡œë“œ
      await loadTestData();
      log('performance', 'âœ… ì˜¤í”„ë¼ì¸ ìƒíƒœì—ì„œ ë¡œì»¬ ë°ì´í„° ì ‘ê·¼ ì„±ê³µ');
    }

    async function testMemoryUsage() {
      log('performance', 'ğŸ’¾ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í…ŒìŠ¤íŠ¸...');

      const usage = await getMemoryUsage();
      log('performance', `í˜„ì¬ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: ${usage}`);

      // ëŒ€ëŸ‰ ë°ì´í„° ìƒì„±
      log('performance', 'ëŒ€ëŸ‰ ë°ì´í„° ìƒì„± ì¤‘...');
      const largeData = [];
      for (let i = 0; i < 100; i++) {
        largeData.push({
          handNumber: `BULK-${i}`,
          data: new Array(1000).fill('x').join('')
        });
      }

      const usageAfter = await getMemoryUsage();
      log('performance', `ë°ì´í„° ìƒì„± í›„ ë©”ëª¨ë¦¬: ${usageAfter}`);
    }

    async function getMemoryUsage() {
      if (performance.memory) {
        const used = (performance.memory.usedJSHeapSize / 1024 / 1024).toFixed(2);
        const total = (performance.memory.totalJSHeapSize / 1024 / 1024).toFixed(2);
        return `${used}MB / ${total}MB`;
      }
      return 'N/A';
    }

    function updateTestSummary(category, tests) {
      const passed = tests.filter(t => t.passed).length;
      const total = tests.length;
      const percentage = Math.round((passed / total) * 100);

      const summaryEl = document.getElementById('test-summary');
      const resultClass = percentage === 100 ? 'test-pass' : percentage >= 50 ? 'test-pending' : 'test-fail';

      const resultDiv = document.createElement('div');
      resultDiv.className = `test-result ${resultClass}`;
      resultDiv.innerHTML = `
        <strong>${category}</strong>: ${passed}/${total} í…ŒìŠ¤íŠ¸ í†µê³¼ (${percentage}%)
      `;

      if (summaryEl.children[0].classList.contains('test-pending') &&
          summaryEl.children[0].textContent.includes('ì‹œì‘í•˜ë ¤ë©´')) {
        summaryEl.innerHTML = '';
      }

      summaryEl.appendChild(resultDiv);
    }
  </script>
</body>
</html>