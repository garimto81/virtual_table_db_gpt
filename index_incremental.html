<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>í¬ì»¤ í•¸ë“œ ëª¨ë‹ˆí„°ë§ v10.3.0 - Incremental Updates</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="performance_monitor.js"></script>
  <script src="checksum_manager.js"></script>
  <script src="incremental_manager.js"></script>
  <style>
    body {
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
      color: #e2e8f0;
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    }
    .metric-card {
      background: rgba(30, 41, 59, 0.8);
      border: 1px solid #334155;
      border-radius: 8px;
      padding: 16px;
    }
    .row-added {
      animation: slideIn 0.5s ease-out;
      background-color: rgba(34, 197, 94, 0.2);
    }
    .row-deleted {
      animation: slideOut 0.3s ease-in;
      background-color: rgba(239, 68, 68, 0.2);
    }
    .cell-updated {
      animation: flashUpdate 0.5s ease-out;
      background-color: rgba(59, 130, 246, 0.3);
    }
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes slideOut {
      from { opacity: 1; transform: scale(1); }
      to { opacity: 0; transform: scale(0.95); }
    }
    @keyframes flashUpdate {
      0% { background-color: rgba(59, 130, 246, 0.6); }
      100% { background-color: transparent; }
    }
  </style>
</head>
<body>
  <!-- í—¤ë” -->
  <div class="bg-slate-900/95 border-b border-slate-700 p-4 sticky top-0 z-50">
    <div class="max-w-7xl mx-auto flex items-center justify-between">
      <div class="flex items-center gap-4">
        <h1 class="text-xl font-bold">í¬ì»¤ í•¸ë“œ ëª¨ë‹ˆí„°ë§</h1>
        <span class="text-xs text-gray-500">v10.3.0 Incremental</span>
        <div class="flex items-center gap-2">
          <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse" id="status-indicator"></span>
          <span class="text-xs text-gray-400" id="status-text">ì¤€ë¹„ ì¤‘...</span>
        </div>
      </div>
      <div class="flex items-center gap-3">
        <select id="mode-selector" onchange="switchMode()" class="px-2 py-1 bg-gray-700 text-white rounded text-sm">
          <option value="incremental">ğŸ”º ì¦ë¶„ ëª¨ë“œ</option>
          <option value="checksum">âœ… Checksum ëª¨ë“œ</option>
          <option value="legacy">âŒ ë ˆê±°ì‹œ ëª¨ë“œ</option>
        </select>
        <button onclick="showStats()" class="px-3 py-1 bg-blue-600 text-white rounded text-sm">
          ğŸ“Š í†µê³„
        </button>
        <button onclick="simulateChanges()" class="px-3 py-1 bg-purple-600 text-white rounded text-sm">
          ğŸ² ë³€ê²½ ì‹œë®¬ë ˆì´ì…˜
        </button>
        <button onclick="forceRefresh()" class="px-3 py-1 bg-yellow-600 text-white rounded text-sm">
          ğŸ”„ ìƒˆë¡œê³ ì¹¨
        </button>
      </div>
    </div>
  </div>

  <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
  <div class="max-w-7xl mx-auto p-6">
    <!-- ì„±ëŠ¥ ë©”íŠ¸ë¦­ ëŒ€ì‹œë³´ë“œ -->
    <div class="grid grid-cols-5 gap-4 mb-6">
      <div class="metric-card">
        <div class="text-xs text-gray-400 mb-1">ë°ì´í„° ì ˆì•½</div>
        <div id="data-savings" class="text-2xl font-bold text-green-400">0%</div>
      </div>
      <div class="metric-card">
        <div class="text-xs text-gray-400 mb-1">ì¦ë¶„ ì—…ë°ì´íŠ¸</div>
        <div id="incremental-count" class="text-2xl font-bold text-blue-400">0</div>
      </div>
      <div class="metric-card">
        <div class="text-xs text-gray-400 mb-1">ì „ì²´ ë™ê¸°í™”</div>
        <div id="full-sync-count" class="text-2xl font-bold">0</div>
      </div>
      <div class="metric-card">
        <div class="text-xs text-gray-400 mb-1">ì¶©ëŒ í•´ê²°</div>
        <div id="conflicts-resolved" class="text-2xl font-bold text-yellow-400">0</div>
      </div>
      <div class="metric-card">
        <div class="text-xs text-gray-400 mb-1">íš¨ìœ¨ì„±</div>
        <div id="efficiency" class="text-2xl font-bold text-purple-400">0%</div>
      </div>
    </div>

    <!-- ë¸íƒ€ ì‹œê°í™” -->
    <div class="grid grid-cols-3 gap-4 mb-6">
      <div class="metric-card">
        <h3 class="text-sm font-bold mb-3 text-green-400">â• ì¶”ê°€ëœ í–‰</h3>
        <div id="added-rows" class="h-20 overflow-y-auto text-xs">
          <div class="text-gray-500">ë³€ê²½ì‚¬í•­ ì—†ìŒ</div>
        </div>
      </div>
      <div class="metric-card">
        <h3 class="text-sm font-bold mb-3 text-blue-400">âœï¸ ìˆ˜ì •ëœ í–‰</h3>
        <div id="modified-rows" class="h-20 overflow-y-auto text-xs">
          <div class="text-gray-500">ë³€ê²½ì‚¬í•­ ì—†ìŒ</div>
        </div>
      </div>
      <div class="metric-card">
        <h3 class="text-sm font-bold mb-3 text-red-400">ğŸ—‘ï¸ ì‚­ì œëœ í–‰</h3>
        <div id="deleted-rows" class="h-20 overflow-y-auto text-xs">
          <div class="text-gray-500">ë³€ê²½ì‚¬í•­ ì—†ìŒ</div>
        </div>
      </div>
    </div>

    <!-- ë°ì´í„° í…Œì´ë¸” -->
    <div class="metric-card">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-lg font-bold">ì‹œíŠ¸ ë°ì´í„°</h2>
        <div class="flex items-center gap-4 text-sm">
          <div>ëª¨ë“œ: <span id="current-mode" class="font-bold text-blue-400">ì¦ë¶„</span></div>
          <div>í–‰ ìˆ˜: <span id="row-count" class="font-bold">0</span></div>
          <div>ë²„ì „: <span id="version-display" class="font-mono text-xs">-</span></div>
        </div>
      </div>
      <div id="data-container" class="overflow-x-auto">
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="text-left p-2">#</th>
              <th class="text-left p-2">Aì—´</th>
              <th class="text-left p-2">Bì—´</th>
              <th class="text-left p-2">Cì—´</th>
              <th class="text-left p-2">Dì—´</th>
              <th class="text-left p-2">Eì—´ (ìƒíƒœ)</th>
              <th class="text-left p-2">ì•¡ì…˜</th>
            </tr>
          </thead>
          <tbody id="data-tbody">
            <tr>
              <td colspan="7" class="text-center p-4 text-gray-500">ë°ì´í„° ë¡œë”© ì¤‘...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ì‹¤ì‹œê°„ ë¡œê·¸ -->
    <div class="metric-card mt-6">
      <h2 class="text-lg font-bold mb-4">ğŸ“ ì‹¤ì‹œê°„ ë¡œê·¸</h2>
      <div id="log-container" class="h-48 overflow-y-auto bg-black/30 rounded p-3 font-mono text-xs">
        <div class="text-green-400">[ì‹œìŠ¤í…œ] ì¦ë¶„ ì—…ë°ì´íŠ¸ ëª¨ë“œ ì¤€ë¹„ ì™„ë£Œ</div>
      </div>
    </div>
  </div>

  <!-- í†µê³„ ëª¨ë‹¬ -->
  <div id="stats-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
    <div class="bg-slate-800 rounded-lg p-6 max-w-2xl w-full">
      <h3 class="text-xl font-bold mb-4">ğŸ“Š ìƒì„¸ í†µê³„</h3>
      <div class="grid grid-cols-2 gap-6">
        <div>
          <h4 class="font-bold mb-2 text-blue-400">ì¦ë¶„ ì—…ë°ì´íŠ¸</h4>
          <div id="incremental-stats" class="space-y-1 text-sm">
            <!-- ë™ì  ìƒì„± -->
          </div>
        </div>
        <div>
          <h4 class="font-bold mb-2 text-purple-400">ì¶©ëŒ í•´ê²°</h4>
          <div id="conflict-stats" class="space-y-1 text-sm">
            <!-- ë™ì  ìƒì„± -->
          </div>
        </div>
      </div>
      <div class="mt-4 flex gap-4">
        <button onclick="exportStats()" class="px-4 py-2 bg-green-600 text-white rounded">
          ğŸ“¥ í†µê³„ ë‚´ë³´ë‚´ê¸°
        </button>
        <button onclick="resetStats()" class="px-4 py-2 bg-red-600 text-white rounded">
          ğŸ—‘ï¸ í†µê³„ ë¦¬ì…‹
        </button>
        <button onclick="closeStats()" class="px-4 py-2 bg-gray-600 text-white rounded">
          ë‹«ê¸°
        </button>
      </div>
    </div>
  </div>

  <script>
    // Google Apps Script URL (ì‹¤ì œ URLë¡œ êµì²´ í•„ìš”)
    const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec';

    // ë§¤ë‹ˆì € ì¸ìŠ¤í„´ìŠ¤
    let incrementalManager = null;
    let checksumManager = null;
    let currentMode = 'incremental';
    let legacyInterval = null;

    // ë¡œê·¸ ì¶”ê°€
    function addLog(message, type = 'info') {
      const logContainer = document.getElementById('log-container');
      const timestamp = new Date().toLocaleTimeString('ko-KR');

      let prefix = '[ì •ë³´]';
      let colorClass = 'text-gray-300';

      if (type === 'success') {
        prefix = '[ì„±ê³µ]';
        colorClass = 'text-green-400';
      } else if (type === 'error') {
        prefix = '[ì˜¤ë¥˜]';
        colorClass = 'text-red-400';
      } else if (type === 'warning') {
        prefix = '[ê²½ê³ ]';
        colorClass = 'text-yellow-400';
      } else if (type === 'delta') {
        prefix = '[ë¸íƒ€]';
        colorClass = 'text-blue-400';
      }

      const entry = document.createElement('div');
      entry.className = colorClass;
      entry.textContent = `${timestamp} ${prefix} ${message}`;
      logContainer.appendChild(entry);
      logContainer.scrollTop = logContainer.scrollHeight;
    }

    // UI ì—…ë°ì´íŠ¸
    function updateUI(data) {
      const tbody = document.getElementById('data-tbody');

      if (!data || data.length === 0) {
        tbody.innerHTML = '<tr><td colspan="7" class="text-center p-4 text-gray-500">ë°ì´í„° ì—†ìŒ</td></tr>';
        return;
      }

      // ìµœëŒ€ 20ê°œ í–‰ í‘œì‹œ
      const displayData = data.slice(0, 20);

      tbody.innerHTML = displayData.map((row, index) => `
        <tr class="border-b border-gray-700/50 hover:bg-gray-800/30" id="row-${index}">
          <td class="p-2 text-gray-400">${index + 1}</td>
          <td class="p-2">${row[0] || '-'}</td>
          <td class="p-2">${row[1] || '-'}</td>
          <td class="p-2">${row[2] || '-'}</td>
          <td class="p-2">${row[3] || '-'}</td>
          <td class="p-2">
            <span class="px-2 py-1 rounded text-xs ${
              row[4] === 'ì™„ë£Œ' ? 'bg-green-600' : 'bg-gray-600'
            }">
              ${row[4] || 'ëŒ€ê¸°'}
            </span>
          </td>
          <td class="p-2">
            <button onclick="editCell(${index}, 4)" class="px-2 py-1 bg-blue-600 hover:bg-blue-700 text-xs rounded">
              í¸ì§‘
            </button>
          </td>
        </tr>
      `).join('');

      // í–‰ ìˆ˜ ì—…ë°ì´íŠ¸
      document.getElementById('row-count').textContent = data.length;

      addLog(`UI ì—…ë°ì´íŠ¸: ${displayData.length}ê°œ í–‰ í‘œì‹œ`, 'success');
    }

    // ë¸íƒ€ ì‹œê°í™” ì—…ë°ì´íŠ¸
    function updateDeltaVisualization(delta) {
      // ì¶”ê°€ëœ í–‰
      const addedDiv = document.getElementById('added-rows');
      if (delta.added && delta.added.length > 0) {
        addedDiv.innerHTML = delta.added.map(add =>
          `<div class="text-green-400">í–‰ ${add.row + 1}: ${add.data.slice(0, 2).join(', ')}...</div>`
        ).join('');
      } else {
        addedDiv.innerHTML = '<div class="text-gray-500">ë³€ê²½ì‚¬í•­ ì—†ìŒ</div>';
      }

      // ìˆ˜ì •ëœ í–‰
      const modifiedDiv = document.getElementById('modified-rows');
      if (delta.modified && delta.modified.length > 0) {
        modifiedDiv.innerHTML = delta.modified.map(mod =>
          `<div class="text-blue-400">í–‰ ${mod.row + 1}: ${mod.cells.length}ê°œ ì…€ ë³€ê²½</div>`
        ).join('');
      } else {
        modifiedDiv.innerHTML = '<div class="text-gray-500">ë³€ê²½ì‚¬í•­ ì—†ìŒ</div>';
      }

      // ì‚­ì œëœ í–‰
      const deletedDiv = document.getElementById('deleted-rows');
      if (delta.deleted && delta.deleted.length > 0) {
        deletedDiv.innerHTML = delta.deleted.map(del =>
          `<div class="text-red-400">í–‰ ${del.row + 1} ì‚­ì œë¨</div>`
        ).join('');
      } else {
        deletedDiv.innerHTML = '<div class="text-gray-500">ë³€ê²½ì‚¬í•­ ì—†ìŒ</div>';
      }
    }

    // í†µê³„ ì—…ë°ì´íŠ¸
    function updateStats() {
      if (incrementalManager) {
        const stats = incrementalManager.getStats();

        document.getElementById('incremental-count').textContent = stats.incrementalUpdates;
        document.getElementById('full-sync-count').textContent = stats.fullSyncs;
        document.getElementById('conflicts-resolved').textContent = stats.conflictsResolved;
        document.getElementById('efficiency').textContent = stats.efficiency;

        // ë°ì´í„° ì ˆì•½ë¥  ê³„ì‚° (ê°€ì •: ì¦ë¶„ ëª¨ë“œëŠ” í‰ê·  90% ì ˆì•½)
        const savings = stats.incrementalUpdates > 0 ? '90%' : '0%';
        document.getElementById('data-savings').textContent = savings;

        // ë²„ì „ í‘œì‹œ
        if (stats.currentVersion) {
          document.getElementById('version-display').textContent = stats.currentVersion;
        }
      }
    }

    // ì¦ë¶„ ëª¨ë“œ ì´ˆê¸°í™”
    async function initializeIncrementalMode() {
      addLog('ì¦ë¶„ ì—…ë°ì´íŠ¸ ëª¨ë“œ ì´ˆê¸°í™”', 'warning');

      try {
        incrementalManager = new IncrementalUpdateManager(APPS_SCRIPT_URL);

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        incrementalManager.on('deltaReceived', (data) => {
          addLog(`ë¸íƒ€ ìˆ˜ì‹ : +${data.stats.added} ~${data.stats.modified} -${data.stats.deleted}`, 'delta');
          updateDeltaVisualization(data.delta);
        });

        incrementalManager.on('deltaApplied', (data) => {
          addLog(`ë¸íƒ€ ì ìš© ì™„ë£Œ (${data.elapsed.toFixed(0)}ms)`, 'success');
          updateUI(data.dataStore);
          updateStats();
        });

        incrementalManager.on('fullSyncRequired', (data) => {
          addLog(`ì „ì²´ ë™ê¸°í™”: ${data.reason}`, 'warning');
          updateUI(data.data);
          updateStats();
        });

        incrementalManager.on('conflictDetected', (data) => {
          addLog(`ì¶©ëŒ ê°ì§€: ${data.conflicts.length}ê°œ (ì „ëµ: ${data.strategy})`, 'warning');
        });

        // í´ë§ ì‹œì‘
        setInterval(async () => {
          try {
            await incrementalManager.fetchUpdate();
          } catch (error) {
            addLog(`ì—…ë°ì´íŠ¸ ì˜¤ë¥˜: ${error.message}`, 'error');
          }
        }, 10000);

        addLog('ì¦ë¶„ ëª¨ë“œ í™œì„±í™” ì™„ë£Œ', 'success');
        document.getElementById('status-text').textContent = 'ì¦ë¶„ ëª¨ë“œ í™œì„±';

      } catch (error) {
        addLog(`ì´ˆê¸°í™” ì‹¤íŒ¨: ${error.message}`, 'error');
      }
    }

    // Checksum ëª¨ë“œ (Day 2ì™€ ë™ì¼)
    function initializeChecksumMode() {
      addLog('Checksum ëª¨ë“œ ì „í™˜', 'warning');
      // ChecksumManager ì´ˆê¸°í™” ë¡œì§
      document.getElementById('status-text').textContent = 'Checksum ëª¨ë“œ';
    }

    // ë ˆê±°ì‹œ ëª¨ë“œ
    function initializeLegacyMode() {
      addLog('ë ˆê±°ì‹œ ëª¨ë“œ ì „í™˜', 'warning');
      document.getElementById('status-text').textContent = 'ë ˆê±°ì‹œ ëª¨ë“œ';
      // ê¸°ì¡´ 10ì´ˆ í´ë§ ë¡œì§
    }

    // ëª¨ë“œ ì „í™˜
    function switchMode() {
      const selector = document.getElementById('mode-selector');
      const newMode = selector.value;

      if (newMode === currentMode) return;

      // ê¸°ì¡´ íƒ€ì´ë¨¸ ì •ë¦¬
      if (legacyInterval) {
        clearInterval(legacyInterval);
        legacyInterval = null;
      }

      currentMode = newMode;
      document.getElementById('current-mode').textContent =
        newMode === 'incremental' ? 'ì¦ë¶„' :
        newMode === 'checksum' ? 'Checksum' : 'ë ˆê±°ì‹œ';

      switch (newMode) {
        case 'incremental':
          initializeIncrementalMode();
          break;
        case 'checksum':
          initializeChecksumMode();
          break;
        case 'legacy':
          initializeLegacyMode();
          break;
      }

      addLog(`ëª¨ë“œ ì „í™˜: ${newMode}`, 'success');
    }

    // ë³€ê²½ ì‹œë®¬ë ˆì´ì…˜
    function simulateChanges() {
      addLog('ë³€ê²½ì‚¬í•­ ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘', 'warning');

      // ëœë¤ ë³€ê²½ ì‹œë®¬ë ˆì´ì…˜
      const changes = [
        { type: 'modify', row: 0, col: 1, value: `ìˆ˜ì •ë¨_${Date.now()}` },
        { type: 'add', data: ['ìƒˆí–‰', 'Bê°’', 'Cê°’', 'Dê°’', 'ëŒ€ê¸°'] },
        { type: 'modify', row: 1, col: 4, value: 'ì™„ë£Œ' }
      ];

      changes.forEach((change, index) => {
        setTimeout(() => {
          if (change.type === 'modify') {
            addLog(`ì…€ (${change.row}, ${change.col}) ìˆ˜ì •: ${change.value}`, 'delta');
          } else if (change.type === 'add') {
            addLog(`ìƒˆ í–‰ ì¶”ê°€: ${change.data.join(', ')}`, 'delta');
          }
        }, index * 1000);
      });
    }

    // ê°•ì œ ìƒˆë¡œê³ ì¹¨
    async function forceRefresh() {
      addLog('ê°•ì œ ìƒˆë¡œê³ ì¹¨ ì‹œì‘', 'warning');

      if (incrementalManager) {
        const result = await incrementalManager.forceFullSync();
        addLog('ì „ì²´ ë™ê¸°í™” ì™„ë£Œ', 'success');
      }
    }

    // í†µê³„ í‘œì‹œ
    function showStats() {
      if (!incrementalManager) {
        alert('ì¦ë¶„ ë§¤ë‹ˆì €ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤');
        return;
      }

      const stats = incrementalManager.getStats();
      const status = incrementalManager.getStatus();

      document.getElementById('incremental-stats').innerHTML = `
        <div class="flex justify-between">
          <span>í´ë¼ì´ì–¸íŠ¸ ID:</span>
          <span class="font-mono text-xs">${stats.clientId}</span>
        </div>
        <div class="flex justify-between">
          <span>ë°ì´í„° í–‰ ìˆ˜:</span>
          <span>${stats.dataRows}</span>
        </div>
        <div class="flex justify-between">
          <span>ì „ì²´ ë™ê¸°í™”:</span>
          <span>${stats.fullSyncs}</span>
        </div>
        <div class="flex justify-between">
          <span>ì¦ë¶„ ì—…ë°ì´íŠ¸:</span>
          <span class="text-green-400">${stats.incrementalUpdates}</span>
        </div>
        <div class="flex justify-between">
          <span>ë¸íƒ€ ì ìš©:</span>
          <span>${stats.deltasApplied}</span>
        </div>
        <div class="flex justify-between">
          <span>íš¨ìœ¨ì„±:</span>
          <span class="text-purple-400">${stats.efficiency}</span>
        </div>
      `;

      document.getElementById('conflict-stats').innerHTML = `
        <div class="flex justify-between">
          <span>ì¶©ëŒ í•´ê²°:</span>
          <span class="text-yellow-400">${stats.conflictsResolved}</span>
        </div>
        <div class="flex justify-between">
          <span>í•´ê²° ì „ëµ:</span>
          <span>${status.conflictStrategy}</span>
        </div>
        <div class="flex justify-between">
          <span>ëŒ€ê¸°ì—´ ê¸¸ì´:</span>
          <span>${status.queueLength}</span>
        </div>
        <div class="flex justify-between">
          <span>ì²˜ë¦¬ ì¤‘:</span>
          <span class="${status.isProcessing ? 'text-yellow-400' : 'text-green-400'}">
            ${status.isProcessing ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'}
          </span>
        </div>
      `;

      document.getElementById('stats-modal').classList.remove('hidden');
    }

    // í†µê³„ ëª¨ë‹¬ ë‹«ê¸°
    function closeStats() {
      document.getElementById('stats-modal').classList.add('hidden');
    }

    // í†µê³„ ë‚´ë³´ë‚´ê¸°
    function exportStats() {
      if (incrementalManager) {
        const stats = incrementalManager.getStats();
        const blob = new Blob([JSON.stringify(stats, null, 2)], {type: 'application/json'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `incremental_stats_${Date.now()}.json`;
        a.click();
        addLog('í†µê³„ íŒŒì¼ ë‚´ë³´ë‚´ê¸° ì™„ë£Œ', 'success');
      }
    }

    // í†µê³„ ë¦¬ì…‹
    function resetStats() {
      if (incrementalManager) {
        incrementalManager.stats = {
          fullSyncs: 0,
          incrementalUpdates: 0,
          conflictsResolved: 0,
          deltasApplied: 0,
          startTime: Date.now()
        };
        updateStats();
        addLog('í†µê³„ ë¦¬ì…‹ ì™„ë£Œ', 'success');
      }
    }

    // ì…€ í¸ì§‘
    function editCell(row, col) {
      const newValue = prompt(`í–‰ ${row + 1}, ì—´ ${col + 1} ê°’ì„ ì…ë ¥í•˜ì„¸ìš”:`);
      if (newValue !== null && incrementalManager) {
        incrementalManager.trackLocalChange(row, col, newValue);
        addLog(`ë¡œì»¬ ë³€ê²½: (${row}, ${col}) = ${newValue}`, 'delta');
      }
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
    window.onload = () => {
      addLog('í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ', 'success');

      // 2ì´ˆ í›„ ìë™ ì‹œì‘
      setTimeout(() => {
        initializeIncrementalMode();
      }, 2000);

      // 30ì´ˆë§ˆë‹¤ í†µê³„ ì—…ë°ì´íŠ¸
      setInterval(updateStats, 30000);
    };
  </script>
</body>
</html>