<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>18:41 ìµœì¢… ìœ„ì¹˜ ì°¾ê¸°</title>
  <style>
    body { font-family: monospace; padding: 20px; background: #1a1a1a; color: #0f0; }
    button { padding: 10px 20px; background: #333; color: #0f0; border: 1px solid #0f0; cursor: pointer; }
    #results { margin-top: 20px; white-space: pre-wrap; border: 1px solid #0f0; padding: 10px; background: #0a0a0a; }
    .found { background: #003300; padding: 5px; margin: 5px 0; border-left: 3px solid #0f0; }
  </style>
</head>
<body>
  <h1>Virtual ì‹œíŠ¸ì—ì„œ 18:41 ì •í™•í•œ ìœ„ì¹˜ ì°¾ê¸°</h1>
  <button onclick="findTime()">ê²€ìƒ‰ ì‹œì‘</button>
  <div id="results"></div>
  
  <script>
    const resultsDiv = document.getElementById('results');
    
    function log(msg, isHighlight = false) {
      const div = document.createElement('div');
      if (isHighlight) div.className = 'found';
      div.textContent = msg;
      resultsDiv.appendChild(div);
    }
    
    function parseCSV(text) {
      const lines = text.split(/\r?\n/);
      const result = [];
      
      for (let i = 0; i < lines.length; i++) {
        const line = lines[i];
        if (!line.trim()) continue;
        
        const row = [];
        let current = '';
        let inQuotes = false;
        
        for (let j = 0; j < line.length; j++) {
          const char = line[j];
          const next = line[j + 1];
          
          if (char === '"' && inQuotes && next === '"') {
            current += '"';
            j++;
          } else if (char === '"') {
            inQuotes = !inQuotes;
          } else if (char === ',' && !inQuotes) {
            row.push(current);
            current = '';
          } else {
            current += char;
          }
        }
        row.push(current);
        result.push(row);
      }
      
      return result;
    }
    
    async function findTime() {
      resultsDiv.innerHTML = '';
      log('ğŸ” Virtual ì‹œíŠ¸ ì ‘ê·¼ ì¤‘...');
      
      const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTq3wrZNUASAMxl9A6VvJxTT6DKj40xp0R2xcIGfeji6MxQ8wi6Zbu_FWPmxKkmJdPHYgMC6UIT9tvv/pub?gid=561799849&single=true&output=csv';
      
      try {
        const response = await fetch(csvUrl);
        const text = await response.text();
        
        // HTML ì²´í¬
        if (text.includes('<!DOCTYPE') || text.includes('<html') || text.includes('<HTML')) {
          log('âš ï¸ HTML ì‘ë‹µ ë°›ìŒ. ì‹œíŠ¸ê°€ ë¹„ê³µê°œ ìƒíƒœì…ë‹ˆë‹¤.');
          log('');
          log('Virtual ì‹œíŠ¸ì—ì„œ ì§ì ‘ í™•ì¸ ë°©ë²•:');
          log('1. Virtual ì‹œíŠ¸ ì—´ê¸°');
          log('2. Ctrl+Fë¡œ "18:41" ê²€ìƒ‰');
          log('3. ì°¾ì€ ì…€ì˜ í–‰ ë²ˆí˜¸ì™€ ì—´ ì•ŒíŒŒë²³ í™•ì¸');
          log('4. ê·¸ ì •ë³´ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”');
          return;
        }
        
        const rows = parseCSV(text);
        log(`âœ… ${rows.length}ê°œ í–‰ ë¡œë“œë¨\n`);
        
        // í—¤ë” í‘œì‹œ
        if (rows.length > 0) {
          log('ğŸ“‹ í—¤ë”:');
          for (let i = 0; i < Math.min(rows[0].length, 10); i++) {
            log(`  ${String.fromCharCode(65 + i)}ì—´: "${rows[0][i]}"`);
          }
          log('');
        }
        
        log('ğŸ¯ 18:41 ê²€ìƒ‰ ì¤‘...\n');
        
        let foundCount = 0;
        const allMatches = [];
        
        // ëª¨ë“  í–‰ê³¼ ì—´ ê²€ìƒ‰
        for (let i = 0; i < rows.length; i++) {
          const row = rows[i];
          
          for (let j = 0; j < row.length; j++) {
            const cell = row[j];
            
            // 18:41 ì°¾ê¸°
            if (cell === '18:41' || cell === '18:41:00') {
              foundCount++;
              const colLetter = String.fromCharCode(65 + j);
              allMatches.push({
                row: i + 1,
                col: colLetter,
                colIndex: j + 1
              });
              
              log(`âœ… ë°œê²¬ #${foundCount}:`, true);
              log(`   ìœ„ì¹˜: í–‰ ${i + 1}, ${colLetter}ì—´ (${j + 1}ë²ˆì§¸ ì—´)`, true);
              log(`   ì „ì²´ í–‰ ë°ì´í„°:`, true);
              for (let k = 0; k < Math.min(row.length, 8); k++) {
                if (row[k] && row[k].trim()) {
                  log(`     ${String.fromCharCode(65 + k)}ì—´: "${row[k]}"`, true);
                }
              }
              log('');
            }
          }
        }
        
        log('=' .repeat(60));
        
        if (foundCount > 0) {
          log('\nğŸ“ ìµœì¢… ë‹µ:');
          allMatches.forEach(m => {
            log(`   18:41ì€ í–‰ ${m.row}, ${m.col}ì—´ì— ìˆìŠµë‹ˆë‹¤`, true);
          });
        } else {
          log('\nâŒ 18:41ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
          
          // 18:4X ì‹œê°„ë“¤ ì°¾ê¸°
          log('\nğŸ’¡ ë¹„ìŠ·í•œ ì‹œê°„ë“¤:');
          let similarCount = 0;
          for (let i = 0; i < Math.min(rows.length, 200); i++) {
            const row = rows[i];
            for (let j = 0; j < row.length; j++) {
              if (row[j] && row[j].match(/18:4\d/)) {
                similarCount++;
                if (similarCount <= 10) {
                  log(`   í–‰ ${i + 1}, ${String.fromCharCode(65 + j)}ì—´: "${row[j]}"`);
                }
              }
            }
          }
        }
        
      } catch (error) {
        log(`âŒ ì˜¤ë¥˜: ${error.message}`);
        log('\nCORS ë¬¸ì œì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
      }
    }
  </script>
</body>
</html>